<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <style>
      body { font-family: Arial, sans-serif; margin: 0; padding: 12px; font-size: 14px; background-color: #f8f9fa; }
      .container { display: flex; flex-direction: column; gap: 10px; }
      .card { border: 1px solid #ddd; border-radius: 4px; padding: 10px; background-color: white; }
      .card-title { font-weight: bold; margin-bottom: 5px; color: #333; }
      .card-content { display: flex; justify-content: space-between; align-items: center; }
      .value { font-weight: bold; font-size: 16px; }
      .suggestion { font-size: 12px; color: #666; }
      .color-box { width: 12px; height: 12px; border: 1px solid #ccc; display: inline-block; vertical-align: middle; margin-right: 5px; }
      hr { border: 0; border-top: 1px solid #eee; margin: 10px 0; }
      
      #suggestion-box { display: none; margin-top: 10px; padding: 8px; background-color: #e9ecef; border-radius: 4px; }
      #suggestion-box strong { color: #0056b3; }
      #suggestion-box ul { margin: 5px 0 0 0; padding-left: 20px; }
      #suggestion-box .error { color: #721c24; }
      .suggestion-btn { width: 100%; padding: 8px; margin-top: 10px; font-size: 0.9em; background-color: #6c757d; color: white; border: none; border-radius: 4px; cursor: pointer; }
      /* NEW: Style for the instruction box */
      .instruction-box { font-size: 0.85em; color: #6c757d; margin-top: 15px; padding: 8px; background-color: #e9ecef; border-radius: 4px; }
      .instruction-box strong { color: #495057; }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="card">
        <div class="card-title">Readability</div>
        <div class="card-content">
          <span><?= data.readabilityLevel ?></span>
        </div>
      </div>

      <div class="card">
        <div class="card-title">Analysis</div>
        <div class="card-content">
          <span><span class="color-box" style="background-color: #FFFF00;"></span>Hard Sentences</span>
          <span class="value"><?= data.hardSentences ?></span>
        </div>
        <hr>
        <div class="card-content">
          <span><span class="color-box" style="background-color: #FFC0CB;"></span>Very Hard Sentences</span>
          <span class="value"><?= data.veryHardSentences ?></span>
        </div>
        <hr>
        <div class="card-content">
          <span><span class="color-box" style="background-color: #ADD8E6;"></span>Adverbs</span>
          <span class="value"><?= data.adverbs ?></span>
        </div>
        <div class="suggestion"><?= data.adverbSuggestion ?></div>
        <hr>
        <div class="card-content">
          <span><span class="color-box" style="background-color: #90EE90;"></span>Passive Voice</span>
          <span class="value"><?= data.passiveVoice ?></span>
        </div>
         <div class="suggestion"><?= data.passiveSuggestion ?></div>
        <hr>
        <div class="card-content">
          <span><span class="color-box" style="background-color: #E6E6FA;"></span>Complex Phrases</span>
          <span class="value"><?= data.complexPhrases ?></span>
        </div>
        <button class="suggestion-btn" onclick="fetchSuggestion()">Get Suggestion for Selected Word</button>
        <div id="suggestion-box"></div>
      </div>

      <!-- NEW: Instruction box for clearing highlights -->
      <div class="instruction-box">
          <strong>To clear highlights:</strong> Select the text, click the Google Docs "Highlight color" icon in the toolbar, and choose "None".
      </div>
    </div>

<script>
  function fetchSuggestion() {
    const box = document.getElementById('suggestion-box');
    box.style.display = 'block';
    box.innerHTML = '<i>Checking word at cursor...</i>';
    google.script.run.withSuccessHandler(function(word) {
      if (word) {
        google.script.run.withSuccessHandler(function(suggestions) {
          if (suggestions && suggestions.length > 0) {
            let html = `<strong>Suggestions for "${word}":</strong><ul>`;
            suggestions.forEach(s => { html += `<li>${s}</li>`; });
            html += '</ul>';
            box.innerHTML = html;
          } else {
            box.innerHTML = `<span class="error">No suggestions found for "${word}".</span>`;
          }
        }).getSuggestionForWord(word);
      } else {
        box.innerHTML = '<span class="error">Please click inside a lavender-highlighted word first.</span>';
      }
    }).getWordAtCursor();
  }
</script>
  </body>
</html>
